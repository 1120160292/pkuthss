% vim:ts=4:sw=4
%
% Copyright (c) 2008-2009 solvethis
% Copyright (c) 2010-2012 Casper Ti. Vector
% Public domain.

\chapter{使用介绍}
	\section{重要文件}
	\subsection{\texttt{tex/} 目录}

	本目录中包含了 pkuthss 文档类和 pkuthss-extra 宏包：
	\begin{itemize}
		\item \verb|pkuthss.cls|：%
			pkuthss 文档类的主文件。
		\item \verb|pkuthss-utf8.def|：%
			pkuthss 文档类中使用的一些标题和标记文字，使用 UTF-8 编码。
		\item \verb|pkuthss-gbk.def|：%
			pkuthss 文档类中使用的一些标题和标记文字，使用 GBK 编码。
		\item \verb|pkuthss-extra.sty|：
			在论文中一些常见的额外设置。
	\end{itemize}

	除此之外，
	pkuthss 文档模版也搭载了作者编写的 biblatex\supercite{biblatex} 样式
	（biblatex-caspervector 宏包\supercite{biblatex-caspervector}），
	用于排版参考文献和引用，
	其文件也置于 \verb|tex/| 目录中，
	包括：
	\begin{itemize}
		\item \verb|caspervector.bbx|
		\item \verb|caspervector.cbx|
		\item \verb|biblatex-caspervector-utf8.def|
		\item \verb|biblatex-caspervector-gbk.def|
	\end{itemize}

	\subsection{\texttt{doc/} 目录}\label{ssec:doc-dir}

	本目录中包含本文档（\verb|README.pdf|）的源代码%
	（\verb|utf8lf/| 和 \verb|gbkcrlf/| 两个子目录，
	两目录中代码除使用的编码和换行符外基本上完全相同），
	以及 pkuthss 文档模版所使用的许可证（\verb|license/| 目录）。

	其中，%
	\verb|utf8lf/| 目录下的源代码使用的是 UTF-8 编码、\verb|\n|（LF）换行，
	适合类 UNIX 系统用户使用；%
	\verb|gbkcrlf/| 目录下的源代码使用的是 GBK 编码、\verb|\r\n|（CRLF）换行，
	适合 Windows 用户使用。%
	\verb|utf8lf/| 和 \verb|gbkcrlf/| 目录中的重要文件有：
	\begin{itemize}
		\item \verb|Makefile|：
			被 Make 工具调用的 Makefile，用于使编译工作自动化。
		\item \verb|Make.bat|：%
			Windows 下的伪“Makefile”，用 Windows 批处理实现。
		\item \verb|chap/|：目录，包含各章节内容：
		\begin{itemize}
			\item \verb|copyright.tex|：
				版权声明部分\footnote{%
					本文档中的版权声明并不是%
					学校默认要求的形式\supercite{pku-copyright}。
					符合学校要求的一个版权声明已经放在此文件中，
					但用 \texttt{\string\iffalse{} ...\ \string\fi} %
					注释掉了，
					用户可以考虑使用那个版本。
				}。
			\item \verb|originauth.tex|：
				原创性声明和使用授权说明部分\supercite{pku-originauth}。
		\end{itemize}
		\item \verb|img/|：目录，包含论文中所有图片：
		\begin{itemize}
			\item \verb|Makefile|：图片部分的 Makefile。
			\item \verb|Make.bat|：%
				Windows 下的伪“Makefile”，用 Windows 批处理实现。
			\item \verb|pkulogo.eps|：北京大学校徽。
			\item \verb|pkuword.eps|：“北京大学”字样。
		\end{itemize}
			\myemph{%
				注：%
				\hologo{pdfLaTeX} 方式编译（见第 \ref{sec:compile} 节）
				可能需要将 eps 图片转换为 pdf 格式，
				而使用 Makefile 或伪“Makefile”时这些图片可以自动生成；
				不使用 Makefile 的用户可以手动运行 %
				\texttt{img/} 目录中的 Makefile 或伪“Makefile”
				来生成这些图片。%
			}
	\end{itemize}

	\section{系统要求}\label{sec:req}

	正确编译需要以下几部分：
	\begin{itemize}
		\item 一个基本的 \TeX{} 发行版。
		\item CJK 或 XeCJK（供 \hologo{XeLaTeX} 使用）宏包。
		\item ctex 宏包\supercite{ctex,ctex-faq}（提供了 ctexbook 文档类）。
		\item 中文字体。
		\item 如果要使用 biblatex 进行文献列表和引用的排版的话，
			还需要 biblatex 宏包\supercite{biblatex}；
		\item 如果需要对中文文献进行按汉语拼音的排序的话，
			还需要 biber 程序\supercite{biber}。
		\item 如果需要使用 Makefile 来实现自动编译，还需要 Make 工具；
			但如果使用由批处理实现的伪“Makefile”就不用了。
	\end{itemize}

	\myemph{最新}的\myemph{完全版} \TeX{}Live 系统（\myemph{%
		注：
		某些 Linux 发行版软件仓库中的 \TeX{}Live 有问题，
		建议使用独立安装版的 \TeX{}Live%
		\footnote{\url{http://www.tug.org/texlive/}.}。%
	}）和 \CTeX{} 套装都已经包含除中文字体和 Make 之外所有要求的项目。%
	\myemph{%
		为了获得最好的支持，
		我们建议用户使用最新完全版的 \TeX{} 系统和各宏包。%
	}根据目前已有的测试结果，
	使用 \TeX{}Live 2009 及其以上稳定版本%
	或 \CTeX{} 套装 v2.8 系列及其以上版本
	的用户可以正常使用本模版。

	中文字体需要用户自行获得。\myemph{%
		注：
		一些中文字体的字库不全，
		只有 GB2312 字符集内字符的字体信息。
		这种情况通常会造成编译生成的 pdf 文件中缺少部分字符，
		其中一种典型症状是封面的“〇”字显示不出来。
		如果要使用中易公司的字体，
		则建议使用 Windows Vista 及其以后版本提供的%
		宋体、黑体、楷体和仿宋体，
		以及 Microsoft Office 2003 及其以后版本提供的隶书和幼圆体，
		这些字体是 GB18030 字符集的，不存在上述问题。%
	}

	Linux 用户可以从软件源获得 GNU 的 make；
	其它类 UNIX 系统应该也会提供 make 工具，请参阅相应的文档以获得帮助。%
	Windows 用户可以从以下地址下载 Windows 下的 GNU make 工具：\\
	\hspace*{\parindent}%
	\url{http://gnuwin32.sourceforge.net/packages/make.htm}

	\section{安装}\label{sec:inst}
	\subsection{“绿色”安装}

	将 \verb|tex/| 中的所有文件复制到 %
	\verb|doc/| 下合适的编码和换行符所对应的目录%
	（\verb|utf8lf/| 或 \verb|gbkcrlf/|）中即可。

	\subsection{非“绿色”安装}

	对于支持 \TeX{} 目录结构（TDS）标准的 \TeX{} 发行版%
	（其中包括 \TeX{}Live 和 \CTeX{}），
	安装 pkuthss 文档模版都可以通过类似的方式：
	将 \verb|tex/| 中内容\footnote{%
		如果已经另外独立安装了 biblatex-caspervector 宏包，
		则不需要重复安装 \texttt{caspervector.*} 和 %
		\texttt{biblatex-caspervector-*.def}。%
	}放在 \verb|$TEXMF/tex/latex/pkuthss/|，
	将本文档（\verb|README.pdf|）和 \verb|doc/| 中内容%
	放在 \verb|$TEXMF/doc/latex/pkuthss/|。
	其中 \verb|$TEXMF| 是用户系统上的 texmf 目录，
	我们推荐使用 \verb|$TEXMFHOME| 或者 \verb|$TEXMFLOCAL|：
	\begin{itemize}
		\item 在 Windows 下，%
			\TeX{}Live 和 \CTeX{} 套装默认的 \verb|$TEXMFHOME| %
			通常可能都是
\begin{Verbatim}[frame = single]
# user 也可改为其它名字，依你的用户名而定。
C:\Documents and Settings\user\texmf
\end{Verbatim}
			而 \verb|$TEXMFLOCAL| 通常可能分别是
\begin{Verbatim}[frame = single]
# C:\Program Files\CTEX 也可改为其它目录，依安装位置而定。
C:\Program Files\CTEX\MiKTeX\texmf-local
\end{Verbatim}
			和
\begin{Verbatim}[frame = single]
# 2010 也可改为其它年份，依 TeXLive 版本而定。
C:\Program Files\texlive\2010\texmf-local
\end{Verbatim}
		\item 在 Linux 和其它类 UNIX 操作系统下，
			\TeX{}Live 默认的 \verb|$TEXMFHOME| 通常可能是
\begin{Verbatim}[frame = single]
$HOME/texmf
\end{Verbatim}
			而 \verb|$TEXMFLOCAL| 通常可能是
\begin{Verbatim}[frame = single]
# 2010 也可改为其它年份，依 TeXLive 版本而定。
/usr/local/texlive/2010/texmf-local
\end{Verbatim}
	\end{itemize}

	用这样的方法安装完宏包后，可能需要刷新一次文件名数据库。
	关于这一步如何操作，详见 \CTeX{} FAQ\supercite{ctex-faq}\footnote{%
		在类 UNIX 操作系统的终端或 Windows 的命令提示符中%
		用 \texttt{texdoc ctex-faq} 调出文档，
		然后在其中搜索“文件名数据库”即可找到。%
	}。

	\section{编译方式}\label{sec:compile}

	pkuthss 文档模版支持三种编译方式，即
	\begin{itemize}
		\item \LaTeX{} -- dvipdfmx 方式：\\
			依次执行 \verb|latex|，\verb|biber|（或 \verb|bibtex|），%
			\verb|latex|，\verb|latex| 和 \verb|dvipdfmx|。
		\item \hologo{pdfLaTeX} 方式：\\
			依次执行 \verb|pdflatex|，\verb|biber|（或 \verb|bibtex|），%
			\verb|pdflatex| 和 \verb|pdflatex|。
		\item \hologo{XeLaTeX} 方式：\\
			依次执行 \verb|xelatex|，\verb|biber|（或 \verb|bibtex|），%
			\verb|xelatex| 和 \verb|xelatex|。\\
			\myemph{%
				注意：\hologo{XeLaTeX} 对非 UTF-8 的编码支持不好，
				因此 \hologo{XeLaTeX} 方式的编译不支持 GBK 编码。
			}
	\end{itemize}

	pkuthss 文档模版附带的 Makefile 中已经对这三种编译方式进行了完整的配置。
	用户只需要在 Makefile 中通过设定变量 \verb|JOBNAME| 的值%
	指定被编译的主文件名，
	并通过设定变量 \verb|LATEX| 的值指定采用哪种编译方式，
	即可通过在主文件所在目录调用 Make 工具来实现自动编译：
	如果是在类 UNIX 环境下，则用户应该调用的命令名为 \verb|make|；
	而如果是在 Windows 环境下，
	则用户应该调用的命令名可能为 \verb|mingw32-make|。

	用户如果不想配置 Windows 下的 GNU Make，
	则也可以使用由 Windows 批处理实现的伪“Makefile”，
	通过在主文件所在目录调用 \verb|make|\footnote{%
		Windows 将批处理文件作为可执行文件，
		调用时可以不显式地指出扩展名。%
	} 或直接双击 \verb|Make.bat| 的图标运行之。

